---
layout: post
title: "IDOR (Insecure Direct Object Reference)"
date: 2025-11-30 18:30:00 -0300
categories: [Vulnerabilidad,IDOR]
tags: [Vulnerabilidad, IDOR, Web]
description: "Vulnerabilidad IDOR (Insecure Direct Object Reference)"
---
## Resumen de la Vulnerabilidad

IDOR (Insecure Direct Object Reference) es una vulnerabilidad de control de acceso que ocurre cuando una aplicación permite acceder a recursos internos usando identificadores directos (IDs, números, nombres de archivo) sin verificar si el usuario tiene permisos para ello.

Esto permite que un atacante acceda a información o funcionalidades que no le corresponden.

## ¿Qué puede hacer un atacante con IDOR?

Un IDOR explotado con éxito puede permitir:

- Acceder a datos de otros usuarios

- Modificar información ajena

- Eliminar recursos sin autorización

- Descargar documentos privados

- Escalar privilegios

## ¿Por qué ocurre IDOR?

IDOR ocurre cuando la aplicación:

- Usa IDs predecibles (números incrementales, UUID visibles)

- Confía solo en el ID enviado por el cliente

- No valida la autorización en el backend

Ejemplo vulnerable:


```bash
GET /profile?id=102
```
Si el servidor no valida permisos, cambiar el ID puede exponer otros perfiles.

## Tipos comunes de IDOR

## IDOR en parámetros URL

Ejemplo:

```bash
GET /invoice?id=123
```
Cambiando el ID:

```bash
GET /invoice?id=124
```
## IDOR en APIs (JSON)

Ejemplo vulnerable:


```bash
{
"user_id": 15
}
```

## IDOR en archivos

Ejemplo:

```bash
GET /uploads/contracts/contract_001.pdf
```

## Ejemplos de pruebas IDOR

```bash
GET /api/users/1
GET /api/users/2
PUT /api/orders/10
DELETE /api/posts/5
```

## Cómo prevenir IDOR

**Buenas prácticas**

- Validar autorización en el servidor

- No confiar en IDs enviados por el cliente

- Usar controles de acceso robustos

- Implementar checks por objeto

- Usar identificadores indirectos cuando sea posible

Ejemplo seguro (lógica backend):


```bash
if (resource.owner_id != current_user.id) {
deny_access();
}
```

## Cómo detectar IDOR en pentesting

- Manipular IDs manualmente

- Probar acceso cruzado entre usuarios

- Revisar endpoints de API

Usar herramientas como:

- Burp Suite

- Postman

- OWASP ZAP

## Severidad

- Media a Alta

- Crítica si expone información sensible o permite acciones administrativas

## Conclusión

vulnerabilidad IDOR (Insecure Direct Object Reference) evidencia una falla en los controles de acceso de la aplicación, permitiendo que un usuario acceda o manipule recursos que no le pertenecen simplemente modificando un identificador enviado por el cliente. Este tipo de vulnerabilidad no requiere técnicas avanzadas, lo que la hace especialmente peligrosa si no se implementan validaciones adecuadas en el servidor.
