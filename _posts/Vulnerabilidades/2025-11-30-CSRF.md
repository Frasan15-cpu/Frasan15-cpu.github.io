---
layout: post
title: "CSRF (Cross-Site Request Forgery)"
date: 2025-11-30 18:30:00 -0300
categories: [Vulnerabilidad,CSRF]
tags: [Vulnerabilidad, CSRF, Web]
description: "Vulnerabilidad CSRF (Cross Site Request Forgery)"
---
## Resumen de la Vulnerabilidad

**Cross-Site Request Forgery (CSRF)** es una vulnerabilidad web que permite a un atacante **forzar a un usuario autenticado** a ejecutar acciones no deseadas en una aplicación web en la que ya tiene una sesión activa.

El ataque se aprovecha de la **confianza que la aplicación tiene en el navegador del usuario**.

## ¿Qué puede hacer un atacante con CSRF?

Un ataque CSRF exitoso puede permitir:

-  Cambiar contraseñas
- Modificar datos del perfil
- Realizar transferencias de dinero
- Ejecutar acciones administrativas
- Eliminar o crear recursos

## ¿Por qué ocurre CSRF?

CSRF ocurre cuando:

- La aplicación no valida la intención del usuario
- Las peticiones sensibles dependen solo de cookies de sesión
- No se usan tokens anti-CSRF
- Se permiten peticiones automáticas desde otros sitios

Ejemplo vulnerable:

```bash
POST /change-password
```
Si el usuario está autenticado, la acción se ejecuta sin validación adicional.

## Ejemplo de ataque CSRF

HTML malicioso:

```bash
<form action="https://victima.com/change-email" method="POST">
  <input type="hidden" name="email" value="attacker@mail.com">
  <input type="submit">
</form>
<script>document.forms[0].submit();</script>
```
Cuando la víctima visita esta página estando logueada, la acción se ejecuta.

## Escenarios comunes

- Cambios de configuración
-  Acciones administrativas
- Formularios sin token CSRF
- APIs que usan solo cookies

## Cómo prevenir CSRF

### Buenas prácticas

- Implementar **tokens anti-CSRF**
- Validar métodos HTTP (`POST`, `PUT`, `DELETE`)
- Usar cookies con `SameSite`
- Requerir reautenticación para acciones críticas
- Verificar encabezados `Origin` y `Referer`

Ejemplo seguro:

```bash
<input type="hidden" name="csrf_token" value="random_token">
```
## Cómo detectar CSRF en pentesting

- Identificar acciones sensibles
- Verificar ausencia de tokens CSRF
- Probar peticiones cross-site
- Revisar cookies `SameSite`
- Usar herramientas como:

  - Burp Suite
  - OWASP ZAP

## Severidad

- **Media**
- **Alta** si afecta acciones críticas o financieras

## Conclusión

La vulnerabilidad de Cross-Site Request Forgery (CSRF) identificada representa un riesgo significativo para la seguridad de la aplicación web, ya que permite a un atacante inducir a un usuario autenticado a ejecutar acciones no autorizadas sin su conocimiento o consentimiento. Esto puede derivar en la modificación de información sensible, cambios en la configuración de la cuenta o ejecución de operaciones críticas aprovechando la sesión activa del usuario.
