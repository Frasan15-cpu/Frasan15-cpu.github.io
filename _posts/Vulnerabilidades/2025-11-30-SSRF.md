---
layout: post
title: "SSRF (Server-Side Request Forgery)"
date: 2025-11-30 18:30:00 -0300
categories: [Vulnerabilidad,SSRF]
tags: [Vulnerabilidad, SSRF, Web]
description: "Vulnerabilidad SSRF (Server-Side Request Forgery)"
---
## Resumen de la Vulnerabilidad

**Server-Side Request Forgery (SSRF)** es una vulnerabilidad web que permite a un atacante **forzar al servidor** a realizar solicitudes HTTP/HTTPS u otros protocolos **hacia destinos internos o externos** que el atacante elige.

El ataque se ejecuta **desde el servidor**, lo que puede exponer servicios internos que no están accesibles públicamente.

## ¿Qué puede hacer un atacante con SSRF?

Un SSRF explotado con éxito puede permitir:

* Acceder a servicios internos (intranet, APIs internas)
* Leer metadatos de la nube (AWS, GCP, Azure)
* Escanear puertos internos
* Exfiltrar información sensible
* Encadenar ataques para lograr RCE

## ¿Por qué ocurre SSRF?

SSRF ocurre cuando la aplicación:

* Acepta URLs controladas por el usuario
* No valida correctamente el destino de la solicitud
* Permite redirecciones
* Confía en el backend para acceder a recursos externos

Ejemplo vulnerable:

```bash
POST /fetch
url=http://example.com/resource
```
## Ejemplos de SSRF

### Acceso a servicios internos

```url
http://127.0.0.1:8080
http://localhost/admin
```
### Metadatos en la nube (AWS)

```url
http://169.254.169.254/latest/meta-data/
```

### Bypass con protocolos alternativos

```url
file:///etc/passwd
ftp://internal-server
```

---

## Técnicas comunes de bypass

* Uso de IPs alternativas (`127.1`, `0.0.0.0`)
* Codificación (`%2f`, `%40`)
* Redirecciones abiertas
* DNS rebinding

---
## Cómo prevenir SSRF

### Buenas prácticas

* Validar y normalizar URLs
* Usar listas blancas de destinos
* Bloquear IPs internas y metadatos
* Deshabilitar redirecciones automáticas
* Separar redes internas

Ejemplo de validación:

```pseudo
if (is_internal_ip(url)) deny();
```
## Cómo detectar SSRF en pentesting

* Identificar funcionalidades que consumen URLs
* Probar destinos internos
* Analizar redirecciones
* Usar herramientas como:

  * Burp Suite
  * Collaborator
  * OWASP ZAP

## Severidad

* **Alta**
* **Crítica** si expone infraestructura interna o cloud

